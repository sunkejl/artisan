语言小谈




数据类型——



联系——动态语言不一定是动态类型语言[3]，动态类型语言也不一定是动态语言[4]。”


数据类型包含两个要素：一个是允许取值的集合，一个是允许参与的运算。




限定一个变量的数据类型，就意味着限制了该变量的取值范围和所参与的运算，这从一定程度上保证了代码的安全性。”



用户自定义的数据类型，如C中的结构和Java中的类或接口，赋予数据以逻辑内涵，提高了代码的抽象性。”



数据类型既有针对机器的物理意义，又有针对人的逻辑意义。前者用于进行底层的内存分配和数值运算等，后者用于表达高层的逻辑概念。既然类型如此重要，类型检查就必不可少了[5]。所谓动态类型语言（dynamictypinglanguage），正是指类型检查发生在运行期间（run-time）的语言。”



静态类型语言（statictypinglanguage）自然是类型检查发生在编译期间（compile-time）的语言



将‘编译期间’4个字改为‘运行之前’，否则容易让人误解为静态类型语言一定是编译型语言（compiledlanguage）。”




“再来看看静态类型语言的好处：由于在运行之前进行了类型检查，一方面代码的可靠性增强，符合‘发现错误要尽早’的原则；
另一方面编译器有可能藉此优化机器代码以提高运行效率，同时相比前者节省了运行期的耗费在类型检查上的时间和空间。
此外，变量类型的声明彰显了编程者的意图，有辅助文档的功效。
两种类型的体制可以用两种法律原则来类比：静态类型检查类似‘疑罪从有’的有罪推定制——在被证明合法之前是非法的，
动态类型检查类似‘疑罪从无’的无罪推定制——在被证明非法之前是合法的。
至于如何取舍，套用一句话：
‘StaticTypingWherePossible,DynamicTypingWhenNeeded’。
不妨理解为：尽可能守规则，必要时求变通。”



类型的动静与强弱完全是正交的两个概念。静态类型语言中，有强类型的Java，也有弱类型的C；动态类型语言中，有强类型的Smalltalk，也有弱类型的JavaScript。前者以类型的绑定（binding）时间来划分，后者以类型的约束强度来划分。通常弱类型语言（weakly-typedlanguage）允许一种类型的值隐性转化为另一种类型[



➢尽管动态语言大多数是动态类型语言，但二者并不是一回事。➢数据类型包含两个要素：允许取值的集合和允许参与的运算。➢数据类型既有针对机器的物理意义，又有针对人的逻辑意义，提高了代码的安全性和抽象性。



➢动态类型的类型检查发生在运行期间，静态类型的类型检查发生在编译期间（运行之前）。➢动态类型的变量不须要显式声明，静态类型的变量须要通过显式声明或类型推断。➢鸭子类型是动态类型的一种风格，允许非继承性多态，即一个对象的类型可以由其接口集合来确定，不须要通过显式继承。它有利于代码重用，但也可能造成误用和滥用。➢动态类型语言的优点：代码简明灵活、易于重用，适合泛型编程和快速原型开发。➢静态类型语言的优点：运行之前的类型检查增强了代码的可靠性，使编译器有可能进行优化处理从而提高运行效率，节省了运行期的类型检查所占用的时间和空间，同时类型声明有辅助文档的功效。➢静态类型检查实行“疑罪从有”的有罪推定制，动态类型检查实行“疑罪从无”的无罪推定制。取舍的原则是：StaticTypingWherePossible,Dynamic
TypingWhenNeeded。即尽可能守规则，必要时求变通。➢类型的动静以类型的绑定时间来划分，类型的强弱以类型的约束强度来划分，它们之间没有必然联系。弱类型语言允许类型的隐性转化，被认为是类型不安全的；而强类型语言则一般不允许这种转化，被认为是类型安全的。



　动态语言——



脚本（script）的提法，是为了区别于一般的程序（program）。



说法：‘Ascriptiswhatyougivetheactors,aprogramiswhatyougivetheaudience’。直译为：脚本是给演员看的，节目是给观众看的。



脚本最常见的形式是壳脚本（shellscript），在非Unix类的操作系统中也称为批处理文件（batchfile）。”




缘由，“操作系统的内核称为核（kernel），出于安全考虑不便直接与用户交互，因此裹上
裹上一层壳（shell），即人们常说的命令行解释器（commandlineinterpreter）。
壳脚本是在壳上运行的脚本，扩展了命令行下可执行的命令。它最初主要是内建（built-in）命令的组合，用于系统程序的调度，是系统管理员的必备武器。其后，壳脚本也发展到用于应用程序的调度、连接、调试等，成为粘合（glue）语言。”

脚本主要用于整合其他程序，本身并不占用太多的资源，同时逻辑也不太复杂。因此，脚本语言注重简洁、实用，语法要求不那么严格，性能上的要求也不高。除壳脚本外，还有一些专用于文本处理（textprocessing）的语言或工具如AWK、sed和grep等，多用于读写配置文件和日志文件、过滤处理各种程序的输入和输出，对于整合各种程序也非常实用。随着对脚本语言需求的增长，其局限性日益突出，以Perl为代表的高级脚本语言便应运而生了。Perl在壳脚本、AWK、sed的基础上，融合了命令式的C与函数式的Lisp的特征，渐渐成为最流行的脚本语言之一。”



外，脚本语言在其他的应用程序中也身影频现，如图形界面应用、多媒体应用、网络应用等。尤其是网络应用，成为滋生和繁荣脚本语言最肥沃的土壤。例如：Perl非常广泛地用于网络服务器端的CGI编程；PHP更是专为动态网页而设计的语言；Ruby虽与Java同岁，但真正开始风行得益于网络应用框架RubyonRails的成功；至于JavaScript，长期被边缘化为网页设计人员的语言，是web2.0的新宠AJAX真正将其带入程序员的视线。”



脚本语言与一般程序一个不同之处是，它一般是面向字符而非数值的，因为字符是最通用的接口，正好发挥其粘合作用，而数值运算对性能要求较高，多
由核心程序来完成。动态语言继承了这个特点，并且除了正则表达式（regularexpression）外，为字符串、数组、列表、集合、映射等常用结构提供了丰富简洁的运算，远比静态语言依赖于库（library）的方便自然得多。”







动态语言能在运行中增加或改变数据结构、函数定义、对象行为或指令流程等。如果说动态类型语言的动态体现在类型上，动态语言的动态则体现在结构和功能上。相比而言，静态语言虽然也可能实现同样的效果，但既不方便也不自然[12]。另外，不容忽视的一点是，动态语言大多是开源的，其本身的发展也更具动态性。”



“动态语言秉承的一个理念是：优化人的时间而不是机器的时间。为提高人的生产率，宁肯牺牲部分的程序性能或者购买更高配置的硬件。由于硬件相对于人件一直在贬值，该理念便有了合理的现实基础。”



从语法上看，动态语言为了更好地粘合来自不同系统、不同语言的程序，对类型的要求一般不如静态语言
语言那么严格，代码更加简洁自由，故而多为动态类型的和弱类型的，天然支持泛型式编程。当然这不是绝对的，





的。大多数动态语言支持eval函数，能动态执行任意字符串形式的代码，并有丰富的反射（reflection）机制，天然支持元编程。动态语言很多还支持包括高阶函数（high-orderfunction）和闭包（closure）等在内的函数式编程。此外，大多动态语言也支持对象式编程，如Python、Ruby、Perl5、PHP



➢程序是为终端用户服务的，脚本是为程序员服务的。➢脚本语言一般是解释型语言，不须要通过“编写－编译－链接－运行”的循环圈，便利快捷，加之简洁宽松的语法、面向字符的特性，以及较强的文本处理能力，尤其适合作为粘合语言，多用于系统管理和集成。



➢脚本语言与动态语言尽管并不完全重合，但更多地还是提法上的区别。前者强调作为命令行工具和粘合工具的语言用途，后者强调动态的语言特征。当脚本语言不再局限于粘合语言，从专用语言发展为通用语言，并且胜任复杂的应用开发的时候，动态语言的提法显然更加合理。➢动态语言能在程序运行期间改变数据结构、函数定义、对象行为或指令流程等，相比静态语言在结构和功能上的更具动态性。➢动态语言重在优化人工时间而非机器时间，因此相比静态语言，其开发效率较高，但运行效率较低。➢动态语言的以下特点决定了它在大型应用开发中的价值：代码量较少，从一定程度减轻了维护难度；不少提供了字节码编译或JIT编译，弥补了运行效率上的不足；一些模块的结构和功能上的变化不会导致相关模块的重新编译和连接；具有灵活、适应力强和开发周期短的特点，能快速响应客户需求的变化，并且适合快速原型开发。➢静态语言安全稳定、性能优越、成熟普及，并且逐渐开始吸纳动态语言的一些优点，这些都决定了它不可能被后者完全替代。



语言误区——




发明一种语言也是对先前语言的一种最高赞美。C++之于C，Java之于C++，C#之于Java，都是后者对前者的一种承认，



编程语言还有一种论调：语言只是一种工具，哪种都差不多。”




编译器或解释器是语言实现的标志。”




对一个程序员而言，编程语言乃立身之本。许多人偏偏本末倒置，常常为在IDE、框架、设计工具等中挖掘到某些新功能而欣喜不已，或者津津乐道于各种语言的优劣高下，却对正在使用的语言中大量的宝藏视而不见，与执金碗而行乞者何异？



架构师需要对语言有更广博、更深刻的认识。





➢过分拔高一种语言与抹煞语言之间的差别是两种极端观点，皆不可取。➢每种语言都有其特到之处和不足之处，与其抱怨争执，不如扬长避短。➢编程语言在批判与赞美中逐步发展。➢编程语言是程序员的立身之本。切不可本末倒置，忽视语言的学习，却热衷于挖掘IDE、框架、设计工具等的新功能。➢语言不等于低级，设计也不等于高级。➢架构师同样关心语言，并且需要对语言有更深更广的认识。



传统的三层架构为：表现层、业务层和数据层。其中表现层可进一步分为客户端的客户层和服务器端的表现层，数据层有时用集成层（integrationtier）和资源层（resourcetier）代替。



一些设计模式（如装饰模式、职责链模式、状态模式、访问者模式等）就是为了赋予静态语言一定的动态特征。










